(this.webpackJsonpfinalproject=this.webpackJsonpfinalproject||[]).push([[0],{30:function(e,t,s){},31:function(e,t,s){},53:function(e,t,s){"use strict";s.r(t);var a=s(1),c=s.n(a),n=s(13),r=s.n(n),i=(s(30),s(31),s(4)),l=s.n(i),o=s(8),j=s(9),d=s.n(j),u=s(15),b=(s(51),s(54)),p=s(55),m=s(3),h=s(2),O=function(){var e=Object(m.g)(),t=Object(a.useRef)(null),s=Object(a.useRef)(null);function c(){return(c=Object(o.a)(l.a.mark((function a(c){var n,r,i,o,j;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(c.preventDefault(),n=t.current.value,r=s.current.value,n&&r){a.next=6;break}return Object(u.b)("Todos los campos son obligatorios",{type:"error"}),a.abrupt("return");case 6:return a.prev=6,a.next=9,d.a.post("https://posts-pw2021.herokuapp.com/api/v1/auth/signin",{username:n,password:r});case 9:200===(i=a.sent).status&&(localStorage.setItem("token",i.data.token),e("/main")),a.next=19;break;case 13:a.prev=13,a.t0=a.catch(6),o=a.t0.response,j="",401===o.status?j="Contrase\xf1a incorrecta":404===o.status?j="Usuario inexistente":500===o.status&&(j="Ups error de servidor, estamos intentando hacer que este problema no prosiga"),Object(u.b)(j,{type:"error"});case 19:case"end":return a.stop()}}),a,null,[[6,13]])})))).apply(this,arguments)}return Object(h.jsx)("div",{className:" loginpage",children:Object(h.jsxs)("form",{className:"formc",onSubmit:function(e){return c.apply(this,arguments)},children:[Object(h.jsx)(u.a,{}),Object(h.jsxs)("div",{className:"conteinerform",children:[Object(h.jsxs)("div",{className:"labls",children:[Object(h.jsx)("label",{className:"username",children:"Username"}),Object(h.jsx)(b.a,{className:"iconouser"}),Object(h.jsx)("input",{className:"inputlogin",type:"text",placeholder:"Username",ref:t})]}),Object(h.jsxs)("div",{className:"labls",children:[Object(h.jsx)("label",{className:"username",children:"Password"}),Object(h.jsx)(p.a,{className:"iconopassword"}),Object(h.jsx)("input",{className:"inputlogin",type:"password",placeholder:"Password",ref:s})]}),Object(h.jsx)("button",{className:"btnlogin",type:"submit",children:"Login"})]})]})})},x=s(7),f=s(56),v=s(57),N=function(e){var t=e.struct,s=t.title,c=t.image,n=t.description,r=t.user,i=t.likes,j=t.comments,u=t._id,b=Object(a.useState)(i.length),p=Object(x.a)(b,2),m=p[0],O=p[1],N=Object(a.useState)(i.some((function(e){return e.user===localStorage.getItem("user")}))),g=Object(x.a)(N,2),k=g[0],_=g[1];function w(){return(w=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/like/".concat(u),null,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:e.sent,k?(O(m-1),_(!1)):(O(m+1),_(!0));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsxs)("div",{className:"allpost",children:[Object(h.jsx)("h1",{id:"titulo",className:"feedbackTitle",children:"Feedback"}),Object(h.jsx)("main",{children:Object(h.jsx)("div",{className:"feedback",children:Object(h.jsx)("div",{className:"conteinerpostF",children:Object(h.jsxs)("div",{className:"postconteiner",children:[Object(h.jsxs)("div",{className:"postF",children:[Object(h.jsx)("div",{className:"name_user",children:Object(h.jsx)("h1",{className:"name_user_e",children:null===r||void 0===r?void 0:r.username})}),Object(h.jsx)("div",{className:"title_of_post",children:Object(h.jsxs)("h2",{className:"title_of_post_e",children:[s," "]})})]}),Object(h.jsx)("div",{className:"imgpostF",children:c&&Object(h.jsx)("div",{className:"insideimg",children:Object(h.jsx)("img",{className:"img_zise",src:c,alt:""})})}),Object(h.jsx)("div",{className:"postconteiner",children:Object(h.jsx)("p",{className:"description_post",children:n})}),Object(h.jsxs)("div",{className:"iconos",children:[Object(h.jsx)("span",{children:Object(h.jsx)(f.a,{className:"".concat(k&&"isLikedBtn"," likeBtn"),onClick:function(){return w.apply(this,arguments)}})}),Object(h.jsx)("span",{children:m}),Object(h.jsx)("span",{children:Object(h.jsx)(v.a,{className:"commentbtn"})}),j.length]})]})})})})]})},g=function(){var e=Object(a.useState)({status:"loading",data:null}),t=Object(x.a)(e,2),s=t[0],c=t[1];return Object(a.useEffect)((function(){function e(){return(e=Object(o.a)(l.a.mark((function e(){var t,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.get("https://posts-pw2021.herokuapp.com/api/v1/post/all?limit=10&page=0",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:t=e.sent,s=t.data,c({status:"done",data:s.data});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),"loading"===s.status?Object(h.jsx)("h1",{children:"Loading..."}):Object(h.jsx)("div",{className:"postcontainer",children:s.data&&s.data.map((function(e){return Object(h.jsx)(N,{struct:e},e._id)}))})},k=function(){function e(){return(e=Object(o.a)(l.a.mark((function e(t){var s,a,c,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),s=new FormData(t.target),a=Object.fromEntries(s.entries()),c=Array.from(s.values()),!c.some((function(e){return""===e}))){e.next=7;break}return e.abrupt("return",alert("Datos incompletos"));case 7:return e.next=10,d.a.post("https://posts-pw2021.herokuapp.com/api/v1/post/create",a,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 10:n=e.sent,console.log(n);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsx)("form",{onSubmit:function(t){return e.apply(this,arguments)},children:Object(h.jsx)("div",{className:"postform",children:Object(h.jsx)("div",{className:"postinput",children:Object(h.jsxs)("div",{className:"postcontainer",children:[Object(h.jsx)("label",{className:"title_create",children:"Crea un post"}),Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{className:"titlee",children:"Titulo"}),Object(h.jsx)("input",{className:"input_title",type:"text",name:"title",placeholder:"ponle un titulo!",id:"title"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{className:"image",children:"Imagen"}),Object(h.jsx)("input",{className:"input_image",type:"text",name:"image",placeholder:"link de la imagen!",id:"image"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{className:"description",children:"Descripcion"}),Object(h.jsx)("input",{className:"input_description",type:"text",name:"description",placeholder:"ponle una descripcion!",id:"description"})]}),Object(h.jsx)("button",{className:"to_post",type:"submit",children:"Publicar!"})]})})})})},_=function(){var e=Object(m.g)(),t=localStorage.getItem("token"),s=(localStorage.getItem("role"),Object(a.useState)()),c=Object(x.a)(s,2),n=(c[0],c[1]);Object(a.useEffect)((function(){function s(){return(s=Object(o.a)(l.a.mark((function e(){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.get("https://posts-pw2021.herokuapp.com/api/v1/auth/whoami",{headers:{Authorization:"Bearer ".concat(t)}});case 2:s=e.sent,n(s),console.log(s.data),localStorage.setItem("role",s.data.role),localStorage.setItem("username",s.data.username);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null===t&&e("/"),function(){s.apply(this,arguments)}()}),[]);return Object(h.jsxs)("div",{className:"all",children:[Object(h.jsx)("div",{className:"allpage",children:Object(h.jsx)("div",{className:"Background_profile",children:Object(h.jsxs)("div",{className:"Container_profile",children:[Object(h.jsx)(b.a,{className:"icon_profile"}),Object(h.jsxs)("div",{className:"lbls",children:[Object(h.jsx)("label",{className:"lbluser",children:" Admin "}),Object(h.jsx)("label",{className:"lblname",children:" Username "})]}),Object(h.jsx)("div",{className:"btnout",children:Object(h.jsx)("button",{className:"btnget_out",onClick:function(){e("/login")},children:"Salir"})})]})})}),Object(h.jsx)("div",{children:Object(h.jsx)(k,{})}),Object(h.jsx)("div",{className:"postsconteiner",children:Object(h.jsx)(g,{})})]})},w=function(){var e=Object(m.g)(),t=localStorage.getItem("token_secondary ");Object(a.useEffect)((function(){null===t&&e("/")}));return Object(h.jsxs)("div",{className:"all",children:[Object(h.jsx)("div",{className:"allpage",children:Object(h.jsx)("div",{className:"Background_profile",children:Object(h.jsxs)("div",{className:"Container_profile",children:[Object(h.jsx)(b.a,{className:"icon_profile"}),Object(h.jsxs)("div",{className:"lbls",children:[Object(h.jsx)("label",{className:"lbluser",children:" User "}),Object(h.jsx)("label",{className:"lblname",children:" Username "})]}),Object(h.jsx)("div",{className:"btnout",children:Object(h.jsx)("button",{className:"btnget_out",onClick:function(){e("/login")},children:"Salir"})})]})})}),Object(h.jsx)("div",{children:Object(h.jsx)(k,{})}),Object(h.jsx)("div",{className:"postsconteiner",children:Object(h.jsx)(g,{})})]})},y=s(17);var S=function(){return Object(h.jsx)(y.a,{children:Object(h.jsxs)(m.d,{children:[Object(h.jsx)(m.b,{path:"/",element:Object(h.jsx)(m.a,{replace:!0,to:"/login"})}),Object(h.jsx)(m.b,{exact:!0,path:"/login",element:Object(h.jsx)(O,{})}),Object(h.jsx)(m.b,{exact:!0,path:"/main",element:Object(h.jsx)(_,{})}),Object(h.jsx)(m.b,{exact:!0,path:"/secondary",element:Object(h.jsx)(w,{})})]})})};r.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(S,{})}),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.b56f26cb.chunk.js.map